# 프로세스 검토 결과 보고서

## 1. 프로젝트 진행 프로세스

### 1. 프로젝트 흐름 및 단계
    1. 학습 데이터 생성
        1. 이미지에서 얼굴 keypoints 좌표 138개 추출
        2. 프레임별 keypoints 좌표 DataFrmae 생성
        3. sequential 데이터 생성
        4. feature scaling  - Standard Scaling
    2. 모델 학습
        1. 성능 개선을 위한 하이퍼파라미터 튜닝
            - Epochs : 1500
            - lr : 0.0001
            - input_size : 136
            - hidden_size : 5
            - num_layers= 2
            - bidirectional = True
            - Dropout_rate= 0.2
            
        2. 성능 평가
           
    3. 모델 적용 및 테스트 
        - 동영상 속 인물 졸음 여부 추론 테스트
        - 웹캠으로 실시간 영상을 입력받아 졸음 감지 테스트
    
### 2. 단계별 참여자
- 김세찬 :  데이터 전처리 및 학습데이터 생성, 모델 학습,  모델 적용 및 테스트, 발표
- 하승주 : 데이터 전처리 및 학습데이터 생성, 모델 학습, 모델 적용 및 테스트, 보고서 작성

### 3. 단계별 사용 도구 및 시스템 
    1. Keypoint Detection : Mediapipe
    2. 모델 적용 및 테스트 : opencv 
    

## 2. 각 프로세스 결과 분석

### 1. 성과 
    1. 학습 데이터 생성 : 이미지에서 얼굴 keypoints 좌표값을 활용해 feature가 136개인 sequential 데이터를 생성
    2. 모델 학습 : 모델 구조 개선, 하이퍼 파라미터 튜닝, 학습 데이터 feature scaling으로 성능을 개선함
    3. 모델 적용 및 테스트 : 실시간 영상을 입력받아 sequence 데이터로 생성한 후 추론 결과 클래스와 확률을 화면에 출력함
       

### 2. 어려웠던 점과 해결 방법
    1. 많은 하이퍼파라미터를 조정하며 모델 성능을 개선하는 과정
→  하이퍼파라미터를 조정하며 실험 결과를 기록함 
        
    2.  실시간 웹캠 영상 추론 및 결과 출력
→ 4.8초 간격의 얼굴 keypoints 좌표를 누적해 dataframe 생성, dataframe의 길이가 5 이상인 때부터 마지막 5개를 하나의 sequence로 생성해 실시간 추론 
    
### 3. 아쉬운 점과 개선 방법
   1. 아쉬운 점
   - 학습 데이터의 프레임 간격이 4.8초이므로, 실시간 영상 추론에 딜레이 발생
   2. 개선책
  - 다양한 상황에서의 졸음 영상 이미지로 pretrain한 모델 활용
  - 더 짧은 프레임 간격으로 캡처된 졸음 영상 활용
  - 프레임 단위로 캡처 가능한 운전자 졸음 데이터가 제한적임을 보완.
  - 다양한 상황의 졸음 영상에서 얼굴만 잘라 모델을 pretrain하고, 운전자의 졸음 이미지 데이터로 finetuning하여 성능을 개선할 수 있음
      
### 4. 활용 방안
- 졸음 전조 증상을 감지하는 용도로 활용 가능
    - 운전자 상태가 ‘정상’인 확률의 변화 ‘약간 졸음’의 패턴을 통해 졸음을 예방하는 조치를 취할 수 있음
    - 특정 시간 동안 ‘약간 졸음’의 감지 횟수를 파악해 알람 작동 
    ex) 1분에 ‘약간 졸음’ 5번 이상 감지되면 알람 작동/ 환기
